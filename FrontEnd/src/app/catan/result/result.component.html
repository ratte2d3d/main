<div class="container">
  <div class="between sub-header">
    <div class="sub-header-item">
      <mat-icon>bar_chart</mat-icon>
      <h2>ランキング</h2>
    </div>
  </div>

  <div class="ranking-results-container">
    
    <div class="ranking-container">
      <h2>プレイ回数</h2>
      <ng-container *ngTemplateOutlet="rankingGroup;context: { $implicit: play_count_ranking, value: 'play_count', unit: '回' }"></ng-container>
    </div>

    <div class="ranking-container">
      <h2>勝利数</h2>
      <ng-container *ngTemplateOutlet="rankingGroup;context: { $implicit: win_count_ranking, value: 'win_count', unit: '回' }"></ng-container>
    </div>

    <div class="ranking-container">
      <h2>勝率</h2>
      <ng-container *ngTemplateOutlet="rankingGroup;context: { $implicit: win_rate_ranking, value: 'win_rate', unit: '%' }"></ng-container>
    </div>

    <div class="ranking-container">
      <h2>総獲得ポイント</h2>
      <ng-container *ngTemplateOutlet="rankingGroup;context: { $implicit: point_ranking, value: 'point', unit: '' }"></ng-container>
    </div>

    <div class="ranking-container">
      <h2>道ボーナス（回数）</h2>
      <ng-container *ngTemplateOutlet="rankingGroup;context: { $implicit: road_count_ranking, value: 'road_count', unit: '回' }"></ng-container>
    </div>

    <div class="ranking-container">
      <h2>道ボーナス（確率）</h2>
      <ng-container *ngTemplateOutlet="rankingGroup;context: { $implicit: road_rate_ranking, value: 'road_rate', unit: '%' }"></ng-container>
    </div>

    <div class="ranking-container">
      <h2>騎士ボーナス（回数）</h2>
      <ng-container *ngTemplateOutlet="rankingGroup;context: { $implicit: army_count_ranking, value: 'army_count', unit: '回' }"></ng-container>
    </div>

    <div class="ranking-container">
      <h2>騎士ボーナス（確率）</h2>
      <ng-container *ngTemplateOutlet="rankingGroup;context: { $implicit: army_rate_ranking, value: 'army_rate', unit: '%' }"></ng-container>
    </div>

  </div>
</div>

<ng-template #rankingGroup let-ranking let-value="value" let-unit="unit">
  <!-- 1位グループ -->
  <div class="top-group">
    <ng-container *ngIf="ranking.length > 0">
      <div class="group-container gold">
        <h2>1位</h2>
        <div class="player-container">
          <div class="player" *ngFor="let player of ranking[0]">
            <img [src]="player?.icon" class="icon" style="border: 3px solid gold" />
            <div class="info">
              <h3>{{ player?.name }}</h3>
              <h3>{{ player?.[value] | number:'1.0-2'}}{{unit}}</h3>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </div>
  <!-- 2位以下グループ（3位まで） -->
  <div class="sub-group">
    <ng-container *ngFor="let group of ranking.slice(1, 3); let rank = index">
      <div class="group-container" [ngClass]="{'silver': rank === 0, 'bronze': rank === 1}">
        <h2>{{ rank + 2 }}位</h2>
        <div class="player-container">
          <div class="player" *ngFor="let player of group">
            <img [src]="player?.icon" class="icon"
              [style.border]="'3px solid ' + (rank === 0 ? 'silver' : rank === 1 ? 'peru' : '#bbb')" />
            <div class="info">
              <h3>{{ player?.name }}</h3>
              <h3>{{ player?.[value] | number:'1.0-2'}}{{unit}}</h3>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </div>
</ng-template>